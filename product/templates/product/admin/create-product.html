{% extends 'product/admin/base.html' %}
{% load i18n %}
{% block js %}
<script src="{{ STATIC_URL }}js/jquery.formset.js"></script>
<script>
$(function(){
    // formset
    var deleteText = '刪除';
    var addText = '新增';

    $('#child_formset').formset({
        formCssClass: 'child-form',
        prefix: 'child',
        deleteText: deleteText,
        addText: addText
    });

    $('input[type="checkbox"]').change(function() {
        if($(this).is(':checked'))
            $('#child_formset').show();
        else
            $('#child_formset').hide();
    });

    $('.optiongroup').on('change', function () {
        var that = $(this)
        $('.options').empty();
        $.get('/empor/admin/render_options/'+$(this).val(), function(response) {
            for (var key in response) {
                $('select.options').append('<option value="'+ response[key].id +'">'+ response[key].name+'</option>');
            }
            $('.options').removeAttr('disabled');
        });
    });

    $('#uploader').pluploadQueue({
        runtimes: 'html5, flash',
        multipart: true,
        headers: {'X-Requested-With': 'XMLHttpRequest', 'X_CSRFToken' : $('input[name*="csrfmiddlewaretoken"]').val()},
        url: '/empor/admin/_upload/',
        max_file_size: '10mb',
        chunk_size: '1mb',
        unique_names: true
    });

});
</script>
{% endblock %}
{% block content %}
{{ collection.name }}
{% for product in products %}
{{ product.name }}
{% endfor %}
<form id="p_edit-form" method="post" class="form-inline">
{% csrf_token %}
    <div class="left">
        <h3>上傳商品圖</h3>
        <div class="control-group">
            <div id="uploader" class="upload_box">Drag photos from your computer here</div>
        </div>
        <div class="control-group">
                <div class="item_img">
                    <div class="hide"><a href="#"><img src="images/remove.png"></a></div>
                    <img src="images/item/10064238_373145_1000.jpg">
                    <input name="item_face" type="radio" value="" id="item_face">
                </div>
                <div class="item_img">
                    <div class="hide"><a href="#"><img src="images/remove.png"></a></div>
                    <img src="images/item/10064238_373147_1000.jpg">
                    <input name="item_face" type="radio" value="" id="item_face">
                </div>
                <div class="item_img">
                    <div class="hide"><a href="#"><img src="images/remove.png"></a></div>
                    <img src="images/item/10064238_373149_1000.jpg">
                    <input name="item_face" type="radio" value="" id="item_face">
                </div>
                <div class="item_img">
                    <div class="hide"><a href="#"><img src="images/remove.png"></a></div>
                    <img src="images/item/10064238_373142_1000.jpg">
                    <input name="item_face" type="radio" value="" id="item_face">
                </div>
        </div>
        <h3>上傳商品樣式縮圖</h3>
        <div class="control-group">
            <input class="input-file" id="fileInput" type="file">
            <div class="form-actions_left"><a href="#" class="button_s">上傳</a></div>
        </div>
        <div class="control-group">
            <div class="img_cut_box"><img src="images/item/10064238_373145_1000.jpg"></div>
        </div>
    </div>
            <div class="right">
                <h3>{% trans 'Product Information' %}</h3>
                {% for field in product_form %}
                <div class="control-group">
                    <label class="control-label">{{ field.label }}</label>
                    <div class="controls">{{ field }}</div>
                </div>
                {% endfor %}
                {{ child_formset.management_form }}
                {{ child_formset.errors }}
                {% for form in child_formset.forms %}
                <div id="child_formset" class="control-group" style="display:none;">
                    <label class="control-label">{% trans 'Stock' %}</label>
                    <div class="controls">
                    {% for field in form %}
                    {{ field }}
                    {% endfor %}
                    </div>
                    <a href="#" class="add_btn"><img src="images/add.png"></a>
                </div>
                {% endfor %}
                
                <br clear="all">
            </div>
            <div class="form-actions">
                <input type="submit" class="button" value="{% trans 'Save' %}" />
            </div>
        </form>
</form>
{% endblock %}
