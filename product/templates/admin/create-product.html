<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></scriptpt src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="{{ STATIC_URL }}js/jquery.formset.js"></script>
<script>
$(function(){
    // formset
    var deleteText = '刪除';
    var addText = '新增';

    $('#child_formset').formset({
        formCssClass: 'child-form',
        prefix: 'child',
        deleteText: deleteText,
        addText: addText
    });

    $('input[type="checkbox"]').change(function() {
        $('#child_formset').toggle();
    });

    $('.optiongroup').live('change', function () {
        var that = $(this)
        $.get('/empor/admin/render_options/'+$(this).val(), function(response) {
            for (var key in response) {
                that.parent().parent().find('select.options').append('<option value="'+ response[key].id +'">'+ response[key].name+'</option>');
            }
        });
    });

});
</script>
</head>
<body>
{{ group.name }}
{% for product in products %}
{{ product.name }}
{% endfor %}
<form method="post">
{% csrf_token %}
<div class="product-form">
{{ product_form.as_p }}
    <div id="child_formset" style="display:none;">
    {{ child_formset.management_form }}
    {% for form in child_formset %}
    <div class="child-form">
    {{ form.as_p }}
    </div>
    {% endfor %}
    </div>
</div>
</div>
<input type="submit" />
</form>
</body>
</html>
